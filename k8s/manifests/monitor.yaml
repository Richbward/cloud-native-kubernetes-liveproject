apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: api-monitor
  namespace: monitoring
  labels:
    layer: api
    release: prom
spec:
  namespaceSelector:
    matchNames:
    - sns
  selector:
    matchLabels:
      layer: api 
  endpoints:
  - port: web
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  generation: 1
  labels:
    app: redis
    release: prom
  name: redis-monitor
  namespace: monitoring
spec:
  endpoints:
  - port: metrics
  namespaceSelector:
    matchNames:
    - sn
  selector:
    matchLabels:
      app: redis
      app.kubernetes.io/component: metrics
